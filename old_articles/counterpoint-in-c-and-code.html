<!--#title:Counterpoint, "In C" and Code-->
<!--#date:2009-07-19 16:06:00-->
<!--#tags:Computing, Music-->

	<p>I recently found some old teaching materials I used to use for an adult-education class in beginners musical theory. It was targeted at interested non-musicians so everything was simply defined with concise examples. I&#8217;d forgotten I&#8217;d written my own musical fragments for explaining counterpoint and was pleasantly surprised at what I&#8217;d produced (inevitably in the style of <a href="http://en.wikipedia.org/wiki/Bach">J.S.Bach</a>). Yesterday I had reason to use the free music typesetting programme <a href="http://lilypond.org/web/">Lilypond</a> for the first time in five years. I was having so much fun that I decided to input my old examples into Lilypond and here are the results (with appropriate commentary):</p>
	<h2>Counterpoint&#8230;</h2>
	<p>...is the pleasing combination of two (or more) different melodies, often of contrasting nature (for example, melodic shape or rhythmic texture). The first melody to be introduced is called the &#8220;Subject&#8221; with additional melodies being called &#8220;Counter Subjects&#8221; (often numbered 1..n if there are more than one).</p>
	<p>Here are two melodies:</p>
	<h3>Subject</h3>
	<p><img src="/images/60.png" title="Contrapuntal Subject" alt="Contrapuntal Subject" /></p>
	<p><a href="http://ntoll.org/files/crab_subject.midi">Listen to example as MIDI</a></p>
	<h3>Counter Subject</h3>
	<p><img src="/images/61.png" title="Counter-subject" alt="Counter-subject" /></p>
	<p><a href="http://ntoll.org/files/similar.mid0">Listen to example as MIDI</a></p>
	<p>Notice how they differ from each other: the &#8220;Subject&#8221; usually moves by leaps and contains many quaver notes making it sound very &#8220;busy&#8221; whereas the Counter Subject usually moves by step and has an altogether less urgent rhythmic feel to it (lots of minims). Notice also that the shapes of the melodies are similar in the first four bars (a general rise then fall) and contrary in the final bars.</p>
	<p>It is these differences between the melodies that make the resulting counterpoint interesting to listen to:</p>
	<h3>Combined Melodies</h3>
	<p><img src="/images/62.png" title="Counterpoint" alt="Counterpoint" /></p>
	<p><a href="http://ntoll.org/files/similar.mid1">Listen to example as MIDI</a></p>
	<p>This is all very clever and hopefully sounds good, but there is more! In contrapuntal musical forms such as the <a href="http://en.wikipedia.org/wiki/Fugue">Fugue</a> once the melodies have been introduced the composer will often &#8220;develop&#8221; the material in cunning and surprising ways. Below is a rather incomplete list of melodic transformations one might employ to keep the listener on their toes (you need to know what you&#8217;re listening for &#8211; but it can turn into quite a good game):</p>
	<ul>
		<li>Inversion &#8211; the original melody is turned upside down. Where the pitch moves up by three notes in the original, it moves down by three notes in the inversion.</li>
		<li>Retrograde &#8211; the melody is played backwards. </li>
		<li>Augmentation &#8211; the duration of the notes in the original melody is lengthened by a constant amount (for example, all note lengths are doubled).</li>
		<li>Diminution &#8211; the opposite of augmentation, the notes are shortened by a constant amount.</li>
	</ul>
	<p>Obviously, these tricks can be combined to get transformations such as retrograde-inversion (backwards and upside-down) or augmented-retrograde (lengthened and backwards), for example. </p>
	<p>Composers will then start to combine these combinations so you might end up with the subject being played in counterpoint to itself as a retrograde-inversion above a third part that is an augmentation of the counter subject. Fantastic stuff!</p>
	<p>To illustrate this point, here is our original contrapuntal example followed by itself in retrograde with the parts swapped between bass and treble (making it a musical palindrome):</p>
	<h3>With Retrograde</h3>
	<p><img src="/images/63.png" title="Counterpoint with retrograde" alt="Counterpoint with retrograde" /></p>
	<p><a href="http://ntoll.org/files/similar.mid2">Listen to example as MIDI</a></p>
	<p>Notice how I make sure the melodies conform to the melodic-minor and introduce a <a href="http://en.wikipedia.org/wiki/Picardy_third">Tierce de Picardie</a> at the end so some of the notes are not <em>exactly</em> the same in either direction.</p>
	<h2>&#8220;In C&#8221;</h2>
	<p>Fast forward to yesterday. I recently discovered a great musical experiment on YouTube called: <a href="http://inbflat.net/">In Bb</a></p>
	<p>As you&#8217;ll see when you click the link, you are presented with YouTube clips of performers playing improvised fragments in the key of B flat major. As the visitor to the site <strong>you</strong> create the &#8220;counterpoint&#8221; by starting, pausing and stopping the videos in a sequence of your choosing. You may even &#8220;mix&#8221; them &#8211; to a limited extent &#8211; by changing the volumes associated with each video. </p>
	<p>Although not the formal &#8220;classical&#8221; counterpoint I describe above, this is definitely the pleasing combination of two (or more) contrasting melodies. I was very impressed. </p>
	<p>After <a href="http://twitter.com/ntoll/status/2684909316">mentioning this on Twitter</a> I was helpfully reminded that it was similar to <a href="http://en.wikipedia.org/wiki/Terry_Riley">Terry Riley&#8217;s</a> <a href="http://www.otherminds.org/SCORES/InC.pdf">In C</a> (the second link is to the score). I was a big fan of this piece when I was at music college and it explained why &#8220;In Bb&#8221; sounded so familiar.</p>
	<p><a href="http://en.wikipedia.org/wiki/In_C">In C</a> is an aleatorical composition (i.e. it includes elements of chance in its performance) and consists of fifty-three short musical &#8220;subjects&#8221; to be performed repeatedly an arbitrary number of times <em>but</em> in sequence. Riley suggests that musicians keep within two-three fragments of each other. </p>
	<p>Once again, this isn&#8217;t the formal &#8220;classical&#8221; counterpoint I described above, but it is the combination of thematic subjects into what has been described as the world&#8217;s first minimalist piece.</p>
	<p>I&#8217;ve found several performances on the Internet: <a href="http://www.flagmusic.com/work.php?r=trjhinc">this one</a> is a midi realisation whereas the following excerpt from a live concert is performed by a symphony orchestra.</p>
	<p><object width="425" height="344"><param name="movie" value="http://www.youtube.com/v/vJSEcoeCgus&#38;hl=en&#38;fs=1&#38;"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/vJSEcoeCgus&#38;hl=en&#38;fs=1&#38;" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="344"></embed></object></p>
	<h2>Code</h2>
	<p>This brings me onto my current vocation (software developer)...</p>
	<p>You can&#8217;t have failed to notice that what makes counterpoint (and music in general) interesting is the introduction of melodies (fragments, subjects or whatever) and their combination and transformation through time. If I replaced the word &#8220;melody&#8221; with &#8220;data structure&#8221; in the preceding sentence then you have a pretty close analogy to how software works. </p>
	<p>Like any analogy, I accept that it isn&#8217;t a completely &#8220;sane&#8221; mapping from one world to the other, but I can&#8217;t help but want to be able to compose music in code. Something along the lines of this (in Python):</p>
<pre>
<code>
subject = melody([ c(4), c(4), g(4), g(4), a(4), a(4), g(2)])
subject.rhythm()
[4, 4, 4, 4, 4, 4, 2] # 6 crotchets followed by a minim
subject.pitch()
[c, c, g, g, a, a, g]
subject.intervals[ 0, 7, 0, 2, 0, -2 ] # intervals between the notes in semi-tones
subject.invert()
[ g, a, a, g, g, c, c ]
</code>
</pre>
	<p>Obviously, I&#8217;d need to work out the <acronym title="Application Programming Interface">API</acronym> in a lot more detail &#8211; the above example is just from the top of my head &#8211; but I think it&#8217;d be great fun to implement something like this.</p>
	<p>Hang on&#8230; <a href="http://github.com/jtauber/sebastian/tree/master">what&#8217;s this..?</a> :-)</p>

 